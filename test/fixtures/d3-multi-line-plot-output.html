<!DOCTYPE html>
<html lang='en'>

<head>

  <link href='http://getbootstrap.com/dist/css/bootstrap.min.css' rel='stylesheet'>
  <link href='http://getbootstrap.com/examples/justified-nav/justified-nav.css' rel='stylesheet'>
  <script src='http://d3js.org/d3.v3.min.js' charset='utf-8'></script>

  <style>

    #visualisation {
      padding: 0 20px;
    }
    
    .axis path {
      fill: none;
      stroke: #777;
      shape-rendering: crispEdges;
    }

    .axis text {
      font-family: Lato;
      font-size: 13px;
    }

  </style>

</head>

<body>

<div class='container'>

  <div class='jumbotron'>
    <svg id='visualisation'></svg>

    <script>

      let heapTotal = JSON.parse('[{"x":0,"y":19959808},{"x":505,"y":21008384},{"x":1008,"y":21008384},{"x":1509,"y":22056960},{"x":2011,"y":30445568},{"x":2512,"y":30445568},{"x":3014,"y":30445568},{"x":3515,"y":30445568},{"x":4015,"y":30445568},{"x":4515,"y":30445568},{"x":5015,"y":30445568},{"x":5515,"y":30445568},{"x":6034,"y":30445568},{"x":6533,"y":30445568},{"x":7033,"y":30445568},{"x":7534,"y":30445568},{"x":8034,"y":30445568},{"x":8534,"y":30445568},{"x":9036,"y":30445568},{"x":9537,"y":30445568},{"x":10038,"y":30445568},{"x":10539,"y":30445568},{"x":11040,"y":30445568},{"x":11541,"y":30445568},{"x":12041,"y":30445568},{"x":12540,"y":30445568},{"x":13042,"y":30445568},{"x":13544,"y":30445568},{"x":14045,"y":30445568},{"x":14545,"y":30445568},{"x":15045,"y":30445568},{"x":15546,"y":30445568},{"x":16048,"y":30445568},{"x":16550,"y":30445568}]');
      let heapUsed = JSON.parse('[{"x":0,"y":10482056},{"x":505,"y":11913024},{"x":1008,"y":14533080},{"x":1509,"y":11810472},{"x":2011,"y":11063104},{"x":2512,"y":12203120},{"x":3014,"y":14647152},{"x":3515,"y":15663392},{"x":4015,"y":10087008},{"x":4515,"y":11240464},{"x":5015,"y":13751352},{"x":5515,"y":14832152},{"x":6034,"y":15394864},{"x":6533,"y":17773344},{"x":7033,"y":12676136},{"x":7534,"y":14099528},{"x":8034,"y":17049488},{"x":8534,"y":10448816},{"x":9036,"y":13242608},{"x":9537,"y":14769880},{"x":10038,"y":17469368},{"x":10539,"y":10845176},{"x":11040,"y":13716992},{"x":11541,"y":15108320},{"x":12041,"y":16001168},{"x":12540,"y":18010376},{"x":13042,"y":13018672},{"x":13544,"y":14496264},{"x":14045,"y":17302928},{"x":14545,"y":10817720},{"x":15045,"y":13642616},{"x":15546,"y":15182832},{"x":16048,"y":17926488},{"x":16550,"y":11179632}]');
      let rss = JSON.parse('[{"x":0,"y":42434560},{"x":505,"y":48316416},{"x":1008,"y":48582656},{"x":1509,"y":48881664},{"x":2011,"y":49238016},{"x":2512,"y":49332224},{"x":3014,"y":50561024},{"x":3515,"y":51605504},{"x":4015,"y":53719040},{"x":4515,"y":53719040},{"x":5015,"y":53895168},{"x":5515,"y":54968320},{"x":6034,"y":58159104},{"x":6533,"y":58318848},{"x":7033,"y":58392576},{"x":7534,"y":58392576},{"x":8034,"y":58392576},{"x":8534,"y":58695680},{"x":9036,"y":58695680},{"x":9537,"y":58695680},{"x":10038,"y":58982400},{"x":10539,"y":59125760},{"x":11040,"y":59125760},{"x":11541,"y":59125760},{"x":12041,"y":59416576},{"x":12540,"y":59441152},{"x":13042,"y":59539456},{"x":13544,"y":59539456},{"x":14045,"y":59539456},{"x":14545,"y":59764736},{"x":15045,"y":59764736},{"x":15546,"y":59764736},{"x":16048,"y":59764736},{"x":16550,"y":59830272}]');

      const values = heapTotal.concat(heapUsed).concat(rss).reduce(function (prev, curr) {

        return {
          xMin: Math.min(prev.xMin, curr.x),
          xMax: Math.max(prev.xMax, curr.x),
          yMin: Math.min(prev.yMin, curr.y),
          yMax: Math.max(prev.yMax, curr.y),
        }

      }, {
        xMin: Number.MAX_SAFE_INTEGER,
        xMax: -1,
        yMin: Number.MAX_SAFE_INTEGER,
        yMax: -1
      });


      let vis = d3.select('#visualisation'),
        WIDTH = 1200,
        HEIGHT = 800,
        MARGINS = {
          top: 20,
          right: 20,
          bottom: 20,
          left: 50
        },
        xScale = d3.scale.linear().range([MARGINS.left, WIDTH - MARGINS.right]).domain([values.xMin - 50, values.xMax + 50]),
        yScale = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([values.yMin - 50, values.yMax + 50]),
        xAxis = d3.svg.axis()
        .scale(xScale),
        yAxis = d3.svg.axis()
        .scale(yScale)
        .orient('left');

      vis.attr("width", WIDTH)
      .attr("height", HEIGHT);

      vis.append('svg:g')
      .attr('class', 'x axis')
      .attr('transform', 'translate(0,' + (HEIGHT - MARGINS.bottom) + ')')
      .call(xAxis);

      vis.append('svg:g')
      .attr('class', 'y axis')
      .attr('transform', 'translate(' + (MARGINS.left) + ',0)')
      .call(yAxis);

      let lineGen = d3.svg.line()
      .x(function (d) {
        return xScale(d.x);
      })
      .y(function (d) {
        return yScale(d.y);
      })
      .interpolate('basis');

      vis.append('svg:path')
      .attr('d', lineGen(heapUsed))
      .attr('stroke', 'green')
      .attr('stroke-width', 2)
      .attr('fill', 'none');

      vis.append('svg:path')
      .attr('d', lineGen(heapTotal))
      .attr('stroke', 'blue')
      .attr('stroke-width', 2)
      .attr('fill', 'none');

      vis.append('svg:path')
      .attr('d', lineGen(rss))
      .attr('stroke', 'red')
      .attr('stroke-width', 2)
      .attr('fill', 'none');


    </script>
  </div>

</div>

</body>

</html>